<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Novyn — Where Moments Connect</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="styles.css?v=20260221b" />
  </head>
  <body>
    <div class="bg-shape bg-shape-one" aria-hidden="true"></div>
    <div class="bg-shape bg-shape-two" aria-hidden="true"></div>
    <div class="grain-layer" aria-hidden="true"></div>

    <main class="app-shell">

      <!-- ─── Top bar ──────────────────────────────── -->
      <header class="app-topbar">
        <div class="brand">
          <svg class="brand-logo" viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg" aria-label="Novyn logo" role="img">
            <defs>
              <linearGradient id="lg1" x1="0" y1="0" x2="42" y2="42" gradientUnits="userSpaceOnUse">
                <stop offset="0%" stop-color="#00e5ff"/>
                <stop offset="100%" stop-color="#7c3aed"/>
              </linearGradient>
            </defs>
            <rect width="42" height="42" rx="13" fill="url(#lg1)"/>
            <rect x="4" y="4" width="34" height="34" rx="9" fill="rgba(5,8,15,0.52)"/>
            <circle class="brand-logo-ring" cx="21" cy="21" r="6"  fill="none" stroke="#00e5ff" stroke-width="2"/>
            <circle class="brand-logo-ring" cx="21" cy="21" r="10" fill="none" stroke="#00e5ff" stroke-width="1.5" opacity="0.7"/>
            <circle class="brand-logo-ring" cx="21" cy="21" r="14" fill="none" stroke="#00e5ff" stroke-width="1"   opacity="0.4"/>
            <circle cx="21" cy="21" r="3" fill="#00e5ff"/>
            <circle cx="15" cy="13" r="2.5" fill="rgba(255,255,255,0.28)"/>
          </svg>
          <div>
            <p class="eyebrow">Where Moments Connect</p>
            <h1>Novyn</h1>
          </div>
        </div>

        <div class="topbar-right">
          <div id="networkPill" class="network-pill" role="status" aria-live="polite">
            <span class="signal-dot" aria-hidden="true"></span>
            <span id="connectionLabel">Connecting…</span>
          </div>
          <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark/light mode" title="Toggle theme">
            <span class="theme-toggle-thumb">
              <svg class="icon-moon" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path d="M10.5 7.5A5 5 0 0 1 4.5 1.5a5 5 0 1 0 6 6z" fill="#c8d7ff" stroke="#c8d7ff" stroke-width="0.5" stroke-linejoin="round"/>
              </svg>
              <svg class="icon-sun" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <circle cx="6" cy="6" r="2.5" fill="#f9a825"/>
                <g stroke="#f9a825" stroke-width="1" stroke-linecap="round">
                  <line x1="6" y1="0.5" x2="6" y2="2"/><line x1="6" y1="10" x2="6" y2="11.5"/>
                  <line x1="0.5" y1="6" x2="2" y2="6"/><line x1="10" y1="6" x2="11.5" y2="6"/>
                  <line x1="2.05" y1="2.05" x2="3.1" y2="3.1"/><line x1="8.9" y1="8.9" x2="9.95" y2="9.95"/>
                  <line x1="9.95" y1="2.05" x2="8.9" y2="3.1"/><line x1="3.1" y1="8.9" x2="2.05" y2="9.95"/>
                </g>
              </svg>
            </span>
          </button>
        </div>
      </header>

      <!-- ─── Login card ───────────────────────────── -->
      <section id="loginCard" class="card login-card" aria-label="Login">

        <!-- Hero panel — redesigned as a chat preview mockup -->
        <div class="login-hero">
          <p class="eyebrow">Where Moments Connect</p>
          <h2>Where every moment finds its place.</h2>
          <p>Add friends, share moments, and stay connected — beautifully, privately, instantly.</p>

          <!-- Chat bubble mockup visual -->
          <div class="hero-visual" aria-hidden="true">
            <div class="hero-mock">
              <!-- Mock chat header -->
              <div class="mock-header">
                <div class="mock-avatar" style="background:linear-gradient(135deg,#00e5ff,#7c3aed)">A</div>
                <div>
                  <div class="mock-name">Aarav</div>
                  <div class="mock-status">
                    <span class="mock-dot"></span>Online
                  </div>
                </div>
              </div>
              <!-- Mock messages -->
              <div class="mock-messages">
                <div class="mock-msg mock-them">
                  <div class="mock-bubble">Hey! Did you see the sunset? 🌅</div>
                  <div class="mock-time">6:41 PM</div>
                </div>
                <div class="mock-msg mock-me">
                  <div class="mock-bubble">It was gorgeous 😍 Sent you some pics!</div>
                  <div class="mock-time">6:42 PM · Delivered</div>
                </div>
                <div class="mock-msg mock-them">
                  <div class="mock-bubble">
                    <span class="mock-reaction-row">❤️ 2</span>
                    Love them! Let's go again tomorrow 🔥
                  </div>
                  <div class="mock-time">6:43 PM</div>
                </div>
                <!-- Typing indicator -->
                <div class="mock-typing">
                  <div class="mock-avatar-sm" style="background:linear-gradient(135deg,#00e5ff,#7c3aed)">A</div>
                  <div class="mock-dots">
                    <span></span><span></span><span></span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <ul class="feature-list">
            <li>Instant updates via WebSockets</li>
            <li>Emoji reactions on every message</li>
            <li>Dark &amp; light themes built in</li>
          </ul>
        </div>

        <!-- Login form panel -->
        <div class="login-panel">
          <div class="login-panel-logo" aria-hidden="true">
            <svg viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg" width="48" height="48">
              <defs>
                <linearGradient id="lg2" x1="0" y1="0" x2="42" y2="42" gradientUnits="userSpaceOnUse">
                  <stop offset="0%" stop-color="#00e5ff"/>
                  <stop offset="100%" stop-color="#7c3aed"/>
                </linearGradient>
              </defs>
              <rect width="42" height="42" rx="13" fill="url(#lg2)"/>
              <rect x="4" y="4" width="34" height="34" rx="9" fill="rgba(5,8,15,0.52)"/>
              <circle cx="21" cy="21" r="6"  fill="none" stroke="#00e5ff" stroke-width="2"/>
              <circle cx="21" cy="21" r="10" fill="none" stroke="#00e5ff" stroke-width="1.5" opacity="0.7"/>
              <circle cx="21" cy="21" r="3" fill="#00e5ff"/>
            </svg>
          </div>
          <h3>Join Novyn</h3>
          <p>New username creates an account. Existing username requires your password.</p>
          <form id="loginForm" novalidate>
            <input id="usernameInput" type="text"     maxlength="24"        placeholder="Username"  autocomplete="username"          required/>
            <input id="passwordInput" type="password" minlength="4" maxlength="72" placeholder="Password" autocomplete="current-password" required/>
            <button type="submit">Enter Novyn →</button>
          </form>
          <p class="login-footnote">🔒 Encrypted password storage &amp; secure session handling.</p>
          <p   id="usernameHint"        class="username-hint hidden"></p>
          <div id="usernameSuggestions" class="username-suggestions hidden"></div>
        </div>
      </section>

      <!-- ─── Chat layout ──────────────────────────── -->
      <section id="chatLayout" class="chat-layout hidden" aria-label="Chat">

        <!-- Sidebar -->
        <aside class="sidebar card" id="mobileSidebar" aria-label="Friends &amp; requests">

          <div class="me-row">
            <div class="me-row-info">
              <div class="me-avatar-wrap">
                <div class="me-avatar" id="meAvatar" aria-hidden="true">?</div>
                <button class="profile-avatar-btn" id="profileBtn" data-profile-open type="button" title="Edit profile" aria-label="Edit profile">
                  <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                    <path d="M12 20h9"/>
                    <path d="M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"/>
                  </svg>
                </button>
              </div>
              <div class="me-row-text">
                <p class="eyebrow">Signed in as</p>
                <h2 id="meName">@you</h2>
                <button class="profile-inline-btn" data-profile-open type="button" aria-label="Open edit profile">
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                    <path d="M12 20h9"/>
                    <path d="M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"/>
                  </svg>
                  Edit profile
                </button>
              </div>
            </div>
            <div class="me-row-btns">
              <button class="logout-btn" id="logoutBtn" title="Log out" aria-label="Log out">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                  <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                  <polyline points="16 17 21 12 16 7"/>
                  <line x1="21" y1="12" x2="9" y2="12"/>
                </svg>
              </button>
            </div>
          </div>

          <form id="addFriendForm" class="add-friend-form">
            <input id="friendInput" type="text" maxlength="24" placeholder="Add friend by username" autocomplete="off" required/>
            <button type="submit">Add</button>
          </form>

          <div class="list-panel" aria-label="Friend requests">
            <div class="list-head">
              <h3>Requests</h3>
              <span id="requestCount" class="count-pill">0</span>
            </div>
            <ul id="requestList" aria-live="polite"></ul>
          </div>

          <div class="list-panel friends-panel" aria-label="Friends">
            <div class="list-head">
              <h3>Friends</h3>
              <span id="friendCount" class="count-pill">0</span>
            </div>
            <ul id="friendList" aria-live="polite"></ul>
          </div>
        </aside>

        <!-- Chat area -->
        <section class="chat card" id="mobileChat" aria-label="Conversation">

          <header class="chat-header">
            <button class="mob-back-btn" id="mobBackBtn" aria-label="Back to friends">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><polyline points="15 18 9 12 15 6"/></svg>
            </button>
            <div id="activePresence" class="active-presence hidden" aria-hidden="true">
              <div id="activeFriendAvatar" class="active-avatar">?</div>
            </div>
            <div class="chat-header-info">
              <p class="eyebrow">Conversation</p>
              <h2 id="activeFriendLabel">Select a friend</h2>
            </div>
            <button id="removeFriendBtn" class="remove-friend-btn hidden" type="button" title="Unfriend" aria-label="Unfriend">
              <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                <circle cx="8.5" cy="7" r="4"/>
                <line x1="17" y1="11" x2="23" y2="11"/>
              </svg>
              <span>Unfriend</span>
            </button>
            <span id="onlineCount" class="mini-stat" aria-live="polite">0 online</span>
          </header>

          <!-- Scroll container + FAB -->
          <div class="messages-wrap">
            <div id="messages" class="messages" role="log" aria-live="polite" aria-label="Messages">
              <div class="messages-empty">Select a friend from the sidebar<br>to start chatting.</div>
            </div>
            <button class="scroll-btn" id="scrollBtn" aria-label="Scroll to latest messages">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><polyline points="6 9 12 15 18 9"/></svg>
              <span class="scroll-btn-badge hidden" id="scrollBadge"></span>
            </button>
          </div>

          <div id="typingIndicator" class="typing-indicator hidden" aria-live="polite" aria-atomic="true">
            <div class="snap-typing-bubble">
              <span class="snap-dot"></span>
              <span class="snap-dot"></span>
              <span class="snap-dot"></span>
            </div>
            <span id="typingText" class="snap-typing-label">Someone is typing</span>
          </div>

          <div class="message-form-wrap">
          <form id="messageForm" class="message-form" autocomplete="off">
              <input
                id="messageInput"
                name="chatMessage"
                type="text"
                placeholder="Type a message…"
                autocomplete="off"
                inputmode="text"
                enterkeyhint="send"
                autocapitalize="sentences"
                autocorrect="on"
                spellcheck="true"
                data-lpignore="true"
                maxlength="1000"
              />
              <button type="submit">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
                Send
              </button>
            </form>
            <div class="char-counter hidden" id="charCounter" aria-live="polite" aria-atomic="true">0 / 1000</div>
          </div>

        </section>
      </section>

      <!-- ─── Profile Modal ─────────────────────── -->
      <div id="profileModal" class="profile-modal" style="display:none;" role="dialog" aria-modal="true" aria-label="Edit Profile">
        <div class="profile-modal-backdrop"></div>
        <div class="profile-modal-card">
          <div class="profile-modal-header">
            <h3>Edit Profile</h3>
            <button class="profile-modal-close" id="profileModalClose" aria-label="Close">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
            </button>
          </div>
          <div class="profile-avatar-preview">
            <div class="profile-avatar-big" id="profileAvatarBig">?</div>
            <p class="profile-avatar-hint">Choose an avatar below</p>
          </div>
          <div class="profile-avatar-grid" id="profileAvatarGrid"></div>
          <div class="profile-fields">
            <div class="profile-field">
              <label for="profileDisplayName">Display Name</label>
              <input id="profileDisplayName" type="text" maxlength="32" placeholder="How friends see you" autocomplete="off"/>
            </div>
            <div class="profile-field-row">
              <div class="profile-field">
                <label for="profileAge">Age</label>
                <input id="profileAge" type="number" min="1" max="120" placeholder="Age" autocomplete="off"/>
              </div>
              <div class="profile-field">
                <label for="profileGender">Gender</label>
                <select id="profileGender">
                  <option value="">Prefer not to say</option>
                  <option value="Male">Male</option>
                  <option value="Female">Female</option>
                  <option value="Non-binary">Non-binary</option>
                  <option value="Other">Other</option>
                </select>
              </div>
            </div>
          </div>
          <button class="profile-save-btn" id="profileSaveBtn">Save Profile</button>
        </div>
      </div>

      <div id="toast" class="toast hidden" role="alert" aria-live="assertive"></div>
    </main>

    <script src="/socket.io/socket.io.js"></script>
    <script src="app.js?v=20260221b"></script>
    <script src="chat-extras.js?v=20260221b"></script>
  </body>
</html>
